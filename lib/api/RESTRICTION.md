NOTE: THE PUBLIC VERSION HAS RESTRICTION - PARTS OF THE CODE CONTAINING A TRADE SECRET HAVE BEEN REMOVED